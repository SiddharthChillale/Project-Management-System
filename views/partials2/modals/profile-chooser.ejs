<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <%- include('../../layouts/header.ejs'); %>

        <title>Choose Profile</title>
</head>

<body>

    <section class="section">
        <div class="container">
            <div class="modal is-active" id="choose-profile">

                <div class="modal-background"></div>
                <div class="modal-content ">
                    <div class="modal-card">
                        <header class="modal-card-head is-shadowless is-radiusless py-2">
                            <p class="modal-card-title has-text-centered has-text-weight-bold">Choose Profile
                            </p>
                        </header>
                        <section class="modal-card-body">
                            <% if (profiles.length==0) { %>
                                <div class="has-text-centered is-size-7">Sorry, but you have no Profiles yet.</div>
                                <div class="has-text-centered is-size-7">Please wait to be assigned a Profile by
                                    your Project Manager or Admin.</div>
                                <div class="has-text-centered is-size-7">
                                    Meanwhile, you can view projects here
                                </div>
                                <button hx-get="/api/v1/projects" hx-target="body" hx-swap="outerHTML"
                                    hx-push-url="true" class="button is-light is-info is-small">View
                                    Projects</button>

                                <% } else { %>

                                    <div class="level">
                                        <% for( let pi=0; pi < profiles.length; pi++ ) { %>

                                            <div class="level-item is-flex is-flex-direction-column">

                                                <figure class="image is-64x64 ">
                                                    <a hx-trigger="click"
                                                        hx-post="<%= `/api/v1/users/profile/choose/`  %>"
                                                        hx-vals='{"profile_Id": "<%= profiles[pi].id %>"}'
                                                        hx-replace-url="/api/v1/users/dashboard" hx-target="body"
                                                        href="<%= `/api/v1/users/profile/choose/`  %>">
                                                        <img id="profile_img" class="is-rounded"
                                                            src="<%= `${profiles[pi].profilePic.url}` %>">
                                                    </a>
                                                </figure>

                                                <div class=" is-size-8 has-text-weight-light is-italic ">

                                                    <button hx-trigger="click" hx-post="/api/v1/users/profile/choose/"
                                                        hx-vals='{"profile_Id": "<%= profiles[pi].id %>"}'
                                                        hx-target="body" hx-replace-url="/api/v1/users/dashboard">
                                                        <%= profiles[pi].role %>
                                                    </button>
                                                </div>
                                            </div>
                                            <% } %>
                                    </div>
                                    <% } %>
                                        <br />
                        </section>

                    </div>
                </div>

            </div>
        </div>
    </section>
</body>

</html>